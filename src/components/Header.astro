---
const base = import.meta.env.BASE_URL ?? '/';
const to = (path: string) => {
  const trimmed = path.replace(/^\//, '');
  const [pathname, hash] = trimmed.split('#');
  const normalized = pathname ? `${pathname.replace(/\/$/, '')}/` : '';
  const suffix = hash ? `#${hash}` : '';
  return `${base}${normalized}${suffix}`;
};

const navItems = [
  { label: 'Start', href: base },
  { label: 'Leistungen', href: to('services') },
  { label: 'Profil', href: to('profile') },
  { label: 'Kontakt', href: to('contact') }
];
---

<header class="sticky top-0 z-50 border-b border-surface-200/80 bg-white/85 shadow-sm backdrop-blur">
  <div class="mx-auto flex max-w-6xl items-center justify-between px-6 py-4">
    <a href={base} data-astro-prefetch class="flex items-center gap-3 text-lg font-semibold text-brand-700 hover:text-brand-500">
      <img src={`${base}favicon.svg`} alt="Tim Friedrich Logo" class="h-10 w-10 rounded-xl shadow-soft" />
      <span class="hidden sm:inline-block">Tim Friedrich · Dynamics 365</span>
    </a>
    <nav class="hidden items-center gap-8 text-sm font-medium text-slate-600 md:flex">
      {navItems.map((item) => (
        <a href={item.href} class="nav-link" data-astro-prefetch>
          {item.label}
        </a>
      ))}
      <a
        href={to('contact')}
        data-astro-prefetch
        class="rounded-xl bg-brand-500 px-4 py-2 text-sm font-semibold text-white shadow-soft transition-colors hover:bg-brand-600 focus-visible:bg-brand-600 hover:text-white focus-visible:text-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-brand-500 focus-visible:ring-offset-white"
      >
        Kostenloses Erstgespräch
      </a>
    </nav>
    <a
      href={to('contact')}
      data-astro-prefetch
      class="rounded-xl bg-brand-500 px-3 py-2 text-sm font-semibold text-white shadow-soft transition-colors hover:bg-brand-600 focus-visible:bg-brand-600 hover:text-white focus-visible:text-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-400 md:hidden"
      aria-label="Kontakt aufnehmen"
    >
      Kontakt
    </a>
  </div>
</header>
